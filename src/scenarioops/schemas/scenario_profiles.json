{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Scenario Profiles",
  "type": "object",
  "required": ["id", "title", "scenarios"],
  "properties": {
    "id": { "type": "string", "minLength": 1 },
    "title": { "type": "string", "minLength": 1 },
    "scenarios": {
      "type": "array",
      "minItems": 1,
      "items": { "$ref": "#/$defs/scenarioProfile" }
    }
  },
  "additionalProperties": false,
  "$defs": {
    "scenarioProfile": {
      "type": "object",
      "required": [
        "id",
        "name",
        "logic",
        "narrative",
        "drivers",
        "assumptions",
        "unknowns",
        "causal_chain",
        "signals",
        "risks",
        "opportunities",
        "implications",
        "options",
        "what_would_change_my_mind",
        "epistemic_refs",
        "confidence"
      ],
      "properties": {
        "id": { "type": "string", "minLength": 1 },
        "name": { "type": "string", "minLength": 1 },
        "logic": { "type": "string", "minLength": 1 },
        "narrative": { "type": "string", "minLength": 1 },
        "drivers": {
          "type": "array",
          "minItems": 1,
          "items": { "$ref": "#/$defs/driverRef" }
        },
        "assumptions": {
          "type": "array",
          "items": { "$ref": "#/$defs/assumptionRef" }
        },
        "unknowns": {
          "type": "array",
          "items": { "$ref": "#/$defs/unknownRef" }
        },
        "causal_chain": {
          "type": "array",
          "items": { "$ref": "#/$defs/chainRef" }
        },
        "signals": {
          "type": "array",
          "items": { "$ref": "#/$defs/signalRef" }
        },
        "risks": {
          "type": "array",
          "items": { "$ref": "#/$defs/riskRef" }
        },
        "opportunities": {
          "type": "array",
          "items": { "$ref": "#/$defs/opportunityRef" }
        },
        "implications": {
          "type": "array",
          "items": { "$ref": "#/$defs/implicationRef" }
        },
        "options": {
          "type": "array",
          "items": { "$ref": "#/$defs/optionRef" }
        },
        "what_would_change_my_mind": {
          "type": "array",
          "items": { "$ref": "#/$defs/triggerRef" }
        },
        "epistemic_refs": { "$ref": "#/$defs/epistemicRefs" },
        "confidence": { "$ref": "#/$defs/scenarioConfidence" }
      },
      "additionalProperties": false
    },
    "driverRef": {
      "type": "object",
      "required": [
        "id",
        "name",
        "category",
        "trend",
        "impact",
        "confidence",
        "confidence_basis",
        "citations"
      ],
      "properties": {
        "id": { "type": "string", "minLength": 1 },
        "name": { "type": "string", "minLength": 1 },
        "category": { "type": "string", "minLength": 1 },
        "trend": { "type": "string", "minLength": 1 },
        "impact": { "type": "string", "minLength": 1 },
        "confidence": { "type": "number", "minimum": 0, "maximum": 1 },
        "confidence_basis": { "type": "string", "minLength": 1 },
        "citations": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["url", "excerpt_hash", "publisher", "evidence_id"],
            "properties": {
              "url": { "type": "string", "minLength": 1 },
              "excerpt_hash": { "type": "string", "minLength": 1 },
              "publisher": { "type": "string", "minLength": 1 },
              "evidence_id": { "type": "string", "minLength": 1 }
            },
            "additionalProperties": false
          }
        }
      },
      "additionalProperties": false
    },
    "assumptionRef": {
      "type": "object",
      "required": [
        "id",
        "statement",
        "uncertainty_id",
        "stance",
        "evidence_ids",
        "confidence",
        "confidence_basis"
      ],
      "properties": {
        "id": { "type": "string", "minLength": 1 },
        "statement": { "type": "string", "minLength": 1 },
        "uncertainty_id": { "type": "string", "minLength": 1 },
        "stance": { "type": "string", "enum": ["dominant", "counter"] },
        "evidence_ids": {
          "type": "array",
          "items": { "type": "string", "minLength": 1 }
        },
        "confidence": { "type": "number", "minimum": 0, "maximum": 1 },
        "confidence_basis": { "type": "string", "minLength": 1 }
      },
      "additionalProperties": false
    },
    "unknownRef": {
      "type": "object",
      "required": [
        "id",
        "statement",
        "evidence_ids",
        "impact",
        "uncertainty",
        "confidence"
      ],
      "properties": {
        "id": { "type": "string", "minLength": 1 },
        "statement": { "type": "string", "minLength": 1 },
        "evidence_ids": {
          "type": "array",
          "items": { "type": "string", "minLength": 1 }
        },
        "impact": { "type": "number", "minimum": 0, "maximum": 1 },
        "uncertainty": { "type": "number", "minimum": 0, "maximum": 1 },
        "confidence": { "type": "number", "minimum": 0, "maximum": 1 }
      },
      "additionalProperties": false
    },
    "chainRef": {
      "type": "object",
      "required": ["id", "belief_id", "order", "description", "domains"],
      "properties": {
        "id": { "type": "string", "minLength": 1 },
        "belief_id": { "type": "string", "minLength": 1 },
        "order": { "type": "integer", "minimum": 1 },
        "description": { "type": "string", "minLength": 1 },
        "domains": {
          "type": "array",
          "items": { "type": "string", "minLength": 1 }
        }
      },
      "additionalProperties": false
    },
    "signalRef": {
      "type": "object",
      "required": ["id", "name", "description", "signal", "metric"],
      "properties": {
        "id": { "type": "string", "minLength": 1 },
        "name": { "type": "string", "minLength": 1 },
        "description": { "type": "string", "minLength": 1 },
        "signal": { "type": "string", "minLength": 1 },
        "metric": { "type": "string", "minLength": 1 },
        "threshold": { "type": "string" }
      },
      "additionalProperties": false
    },
    "riskRef": {
      "type": "object",
      "required": ["description", "source_test_id"],
      "properties": {
        "description": { "type": "string", "minLength": 1 },
        "source_test_id": { "type": "string", "minLength": 1 }
      },
      "additionalProperties": false
    },
    "opportunityRef": {
      "type": "object",
      "required": ["description", "source_test_id"],
      "properties": {
        "description": { "type": "string", "minLength": 1 },
        "source_test_id": { "type": "string", "minLength": 1 }
      },
      "additionalProperties": false
    },
    "implicationRef": {
      "type": "object",
      "required": ["type", "description"],
      "properties": {
        "type": { "type": "string", "minLength": 1 },
        "description": { "type": "string", "minLength": 1 }
      },
      "additionalProperties": false
    },
    "optionRef": {
      "type": "object",
      "required": [
        "strategy_id",
        "action",
        "outcome",
        "feasibility_score",
        "rubric_score"
      ],
      "properties": {
        "strategy_id": { "type": "string", "minLength": 1 },
        "action": { "type": "string", "minLength": 1 },
        "outcome": { "type": "string", "minLength": 1 },
        "feasibility_score": { "type": "number", "minimum": 0, "maximum": 1 },
        "rubric_score": { "type": "number", "minimum": 0, "maximum": 1 }
      },
      "additionalProperties": false
    },
    "triggerRef": {
      "type": "object",
      "required": ["indicator_id", "signal", "metric"],
      "properties": {
        "indicator_id": { "type": "string", "minLength": 1 },
        "signal": { "type": "string", "minLength": 1 },
        "metric": { "type": "string", "minLength": 1 }
      },
      "additionalProperties": false
    },
    "epistemicRefs": {
      "type": "object",
      "required": ["facts", "assumptions", "interpretations", "unknowns"],
      "properties": {
        "facts": { "type": "array", "items": { "type": "string", "minLength": 1 } },
        "assumptions": { "type": "array", "items": { "type": "string", "minLength": 1 } },
        "interpretations": { "type": "array", "items": { "type": "string", "minLength": 1 } },
        "unknowns": { "type": "array", "items": { "type": "string", "minLength": 1 } }
      },
      "additionalProperties": false
    },
    "scenarioConfidence": {
      "type": "object",
      "required": ["overall", "basis"],
      "properties": {
        "overall": { "type": "number", "minimum": 0, "maximum": 1 },
        "basis": { "type": "string", "minLength": 1 }
      },
      "additionalProperties": false
    }
  }
}
